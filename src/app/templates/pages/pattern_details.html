<div
  class="flex h-screen flex-col bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark overflow-hidden"
  data-pattern-root
  data-image-id="{{ image_id or '' }}"
  data-pattern-id="{{ pattern_id or '' }}"
>
  <header
    class="w-full border-b border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark h-16"
  >
    <div
      class="grid h-full w-full grid-cols-3 items-center px-4 sm:px-6 lg:px-8"
    >
      <div class="flex justify-start gap-2">
        <a
          href="{{ url_for('site.home') }}"
          class="inline-flex items-center justify-center rounded-full border border-border-light dark:border-border-dark p-2 text-text-light dark:text-text-dark transition-colors hover:border-primary hover:text-primary focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary"
          aria-label="Home"
          title="Home"
        >
          <span class="material-symbols-outlined text-xl leading-none"
            >home</span
          >
        </a>
        <a
          href="{{ url_for('site.collection') }}"
          class="inline-flex items-center justify-center rounded-full border border-border-light dark:border-border-dark p-2 text-text-light dark:text-text-dark transition-colors hover:border-primary hover:text-primary focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary"
          aria-label="Collection"
          title="Collection"
        >
          <span class="material-symbols-outlined text-xl leading-none"
            >apps</span
          >
        </a>
      </div>
      <div class="flex items-center justify-center gap-3">
        <div class="size-8"></div>
        <h2
          class="text-2xl font-bold text-primary leading-tight tracking-[-0.015em]"
          style="font-family: &quot;Caesar Dressing&quot;, cursive"
        >
          GlyPat
        </h2>
      </div>
      <div class="flex items-center justify-end">
        <div class="flex items-center gap-2">
          <button
            id="themeToggle"
            type="button"
            class="inline-flex items-center justify-center rounded-full border border-border-light dark:border-border-dark p-2 text-text-light dark:text-text-dark transition-colors hover:border-primary hover:text-primary focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary"
            aria-pressed="false"
          >
            <span class="sr-only">Toggle color theme</span>
            <span
              class="material-symbols-outlined text-xl leading-none dark:hidden"
              >dark_mode</span
            >
            <span
              class="material-symbols-outlined hidden text-xl leading-none dark:inline"
              >light_mode</span
            >
          </button>
        </div>
      </div>
    </div>
  </header>

  <main class="flex-1 overflow-hidden">
    <div
      class="mx-auto flex max-w-7xl flex-col gap-4 px-4 py-6 sm:px-6 lg:px-8 h-[90vh]"
    >
      <a
        href="{% if image_id %}{{ url_for('site.ngrams_page', id=image_id) }}{% else %}{{ url_for('site.ngrams_page') }}{% endif %}"
        class="self-start inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold transition-colors hover:text-primary max-w-[220px] whitespace-nowrap"
      >
        <span class="material-symbols-outlined text-base">arrow_back</span>
        Back to N-grams
      </a>
      <div
        class="rounded-2xl border border-border-light dark:border-border-dark bg-card-light dark:bg-card-dark shadow-lg overflow-hidden flex flex-col h-full relative"
        data-pattern-card
      >
        <div
          class="absolute inset-0 z-20 flex flex-col items-center justify-center gap-3 bg-background-light/80 dark:bg-background-dark/80 backdrop-blur-sm hidden"
          data-pattern-loading
        >
          <div class="relative flex h-12 w-12">
            <span
              class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"
            ></span>
            <span
              class="relative inline-flex h-12 w-12 rounded-full bg-primary/70"
            ></span>
          </div>
          <p
            class="text-sm font-semibold tracking-wide uppercase text-text-secondary-light dark:text-text-secondary-dark"
          >
            Loading sentences…
          </p>
        </div>
        <div
          class="flex flex-col gap-3 border-b border-border-light dark:border-border-dark px-6 py-6"
        >
          <div class="space-y-2 flex-1 min-w-0">
            <div class="flex items-center justify-between gap-3">
              <p
                class="text-[11px] font-semibold uppercase tracking-[0.28em] text-primary"
              >
                Detected pattern
              </p>
              <div
                class="flex items-center gap-3 text-sm font-semibold text-text-light dark:text-text-dark"
              >
                <span
                  class="text-xs uppercase tracking-wide text-text-secondary-light dark:text-text-secondary-dark"
                  >Occurrences</span
                >
                <span data-pattern-occurrences>—</span>
                <span class="text-primary font-mono" data-pattern-length
                  >n = —</span
                >
              </div>
            </div>
            <div
              class="rounded-xl border border-border-light dark:border-border-dark bg-white/85 dark:bg-gray-900/75 px-4 py-3 shadow-inner text-2xl font-semibold tracking-widest text-text-light dark:text-text-dark leading-tight min-h-16 w-full max-w-full overflow-x-auto whitespace-nowrap custom-scrollbar custom-scrollbar-thin"
              data-pattern-glyphs
            >
              —
            </div>
          </div>
        </div>

        <div class="flex-1 flex flex-col lg:flex-row min-h-0">
          <aside
            class="w-full lg:w-80 flex-shrink-0 border-b border-border-light dark:border-border-dark lg:border-b-0 lg:border-r bg-card-light/70 dark:bg-card-dark/70 backdrop-blur-sm flex flex-col overflow-hidden"
          >
            <div
              class="border-b border-border-light/80 dark:border-border-dark/80 px-5 py-4 sticky top-0 z-10 bg-card-light/90 dark:bg-card-dark/90 backdrop-blur"
            >
              <p
                class="text-[11px] uppercase tracking-widest font-semibold text-text-secondary-light dark:text-text-secondary-dark"
              >
                Found sentences
              </p>
            </div>
            <nav
              class="flex-1 flex flex-col divide-y divide-border-light/70 dark:divide-border-dark/70 custom-scrollbar overflow-y-auto"
              data-pattern-sentences-list
            ></nav>
            <div
              class="px-5 py-3 text-xs text-text-secondary-light dark:text-text-secondary-dark hidden"
              data-pattern-sentences-empty
            >
              No matching sentences found.
            </div>
          </aside>

          <div
            class="flex-1 bg-card-light/60 dark:bg-card-dark/60 px-6 py-6 space-y-8 overflow-y-auto min-h-0"
            data-pattern-info
          >
            <section class="space-y-3">
              <h3
                class="flex items-center gap-2 text-sm font-bold text-text-light dark:text-text-dark uppercase tracking-wide"
              >
                <span
                  class="material-symbols-outlined text-primary"
                  style="font-size: 20px"
                  >translate</span
                >
                Transcription
              </h3>
              <div
                class="rounded-xl border border-border-light dark:border-border-dark bg-white/80 dark:bg-gray-900/60 px-5 py-4 shadow-sm"
              >
                <p
                  class="text-2xl font-medium italic tracking-wide text-text-light dark:text-text-dark"
                  data-pattern-transcription
                >
                  —
                </p>
              </div>
            </section>

            <section class="space-y-4">
              <h3
                class="flex items-center gap-2 text-sm font-bold text-text-light dark:text-text-dark uppercase tracking-wide"
              >
                <span
                  class="material-symbols-outlined text-primary"
                  style="font-size: 20px"
                  >auto_stories</span
                >
                Meaning
              </h3>
              <div
                class="rounded-xl border border-border-light dark:border-border-dark bg-white/80 dark:bg-gray-900/60 px-5 py-5 shadow-sm space-y-4"
              >
                <p
                  class="text-lg text-text-secondary-light dark:text-text-secondary-dark leading-relaxed"
                  data-pattern-translation
                >
                  —
                </p>
              </div>
            </section>

            <section class="space-y-3">
              <h3
                class="flex items-center gap-2 text-sm font-bold text-text-light dark:text-text-dark uppercase tracking-wide"
              >
                <span
                  class="material-symbols-outlined text-primary"
                  style="font-size: 20px"
                  >rule</span
                >
                Tokens
              </h3>
              <div
                class="rounded-xl border border-border-light dark:border-border-dark bg-white/80 dark:bg-gray-900/60 px-5 py-4 shadow-sm space-y-3"
              >
                <div
                  class="text-sm text-text-secondary-light dark:text-text-secondary-dark hidden"
                  data-pattern-tokens-empty
                >
                  No tokens found for this pattern yet.
                </div>
                <div class="space-y-2" data-pattern-tokens></div>
              </div>
            </section>

            <section class="space-y-3">
              <h3
                class="flex items-center gap-2 text-sm font-bold text-text-light dark:text-text-dark uppercase tracking-wide"
              >
                <span
                  class="material-symbols-outlined text-primary"
                  style="font-size: 20px"
                  >link</span
                >
                Thesaurus Linguae Aegyptiae
              </h3>
              <div class="gap-3 space-y-2" data-pattern-links></div>
            </section>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
